{% extends "layouts/base.html" %}
{% from 'components/page_header.html' import page_header %}

{% block title %}Aide - Configuration Workflows{% endblock %}

{% block styles %}
<style>
.help-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
}

.help-section {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 2rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.help-section h2 {
    color: var(--primary-color);
    margin-bottom: 1.5rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid var(--primary-color);
}

.help-section h3 {
    color: #333;
    margin-top: 1.5rem;
    margin-bottom: 1rem;
}

.schema-box {
    background: #f8f9fa;
    border: 2px solid #dee2e6;
    border-radius: 8px;
    padding: 1.5rem;
    margin: 1rem 0;
    font-family: 'Courier New', monospace;
    overflow-x: auto;
}

.step-box {
    background: white;
    border: 2px solid var(--primary-color);
    border-radius: 8px;
    padding: 1rem;
    margin: 0.5rem 0;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.step-number {
    display: inline-block;
    background: var(--primary-color);
    color: white;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    text-align: center;
    line-height: 30px;
    font-weight: bold;
    margin-right: 0.5rem;
}

.exemple-box {
    background: #e7f3ff;
    border-left: 4px solid #0066cc;
    padding: 1rem 1.5rem;
    margin: 1rem 0;
}

.warning-box {
    background: #fff3cd;
    border-left: 4px solid #ffc107;
    padding: 1rem 1.5rem;
    margin: 1rem 0;
}

.success-box {
    background: #d4edda;
    border-left: 4px solid #28a745;
    padding: 1rem 1.5rem;
    margin: 1rem 0;
}

.flow-diagram {
    text-align: center;
    margin: 2rem 0;
}

.flow-step {
    display: inline-block;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 1rem 1.5rem;
    border-radius: 8px;
    margin: 0.5rem;
    font-weight: 600;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

.flow-arrow {
    font-size: 2rem;
    color: var(--primary-color);
    margin: 0 0.5rem;
}

.code-inline {
    background: #f4f4f4;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    font-family: 'Courier New', monospace;
    color: #e83e8c;
}

.table-help {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
}

.table-help th,
.table-help td {
    padding: 0.75rem;
    border: 1px solid #dee2e6;
    text-align: left;
}

.table-help th {
    background: var(--primary-color);
    color: white;
    font-weight: 600;
}

.table-help tr:nth-child(even) {
    background: #f8f9fa;
}
</style>
{% endblock %}

{% block content %}

{{ page_header(
    title='â“ Aide - Configuration des Workflows',
    breadcrumbs=[
        {'name': 'Accueil', 'url': url_for('accueil')},
        {'name': 'Configuration Workflows', 'url': url_for('workflow_config_home')},
        {'name': 'Aide'}
    ],
    actions=[
        {'label': 'â† Retour Configuration', 'url': url_for('workflow_config_home'), 'primary': True}
    ]
) }}

<div class="help-container">
    
    <!-- Section 1 : Vue d'ensemble -->
    <div class="help-section">
        <h2>ğŸ¯ Qu'est-ce qu'un Workflow PersonnalisÃ© ?</h2>
        
        <p style="font-size: 1.1rem; line-height: 1.8;">
            Un <strong>workflow personnalisÃ©</strong> est un circuit de validation configurable qui dÃ©finit <strong>qui doit valider quoi</strong> dans votre organisation.
        </p>
        
        <div class="success-box">
            <strong>âœ… Avantage principal :</strong> Vous crÃ©ez des circuits qui correspondent exactement Ã  vos processus mÃ©tier rÃ©els, sans Ãªtre limitÃ© par une hiÃ©rarchie organisationnelle fixe.
        </div>
        
        <h3>Les 3 Composants Essentiels</h3>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin: 1.5rem 0;">
            <div class="step-box">
                <div class="step-number">1</div>
                <strong>RÃ´les PersonnalisÃ©s</strong>
                <p style="margin: 0.5rem 0; color: #666;">
                    Des fonctions que vous dÃ©finissez (ex: Responsable Budget, Expert IT, ContrÃ´leur)
                </p>
            </div>
            
            <div class="step-box">
                <div class="step-number">2</div>
                <strong>Templates de Workflow</strong>
                <p style="margin: 0.5rem 0; color: #666;">
                    Des circuits rÃ©utilisables composÃ©s de plusieurs rÃ´les dans un ordre prÃ©cis
                </p>
            </div>
            
            <div class="step-box">
                <div class="step-number">3</div>
                <strong>Types de Demandes</strong>
                <p style="margin: 0.5rem 0; color: #666;">
                    Des formulaires associÃ©s Ã  un template (ex: Demande de MatÃ©riel â†’ Circuit Simple)
                </p>
            </div>
        </div>
    </div>
    
    <!-- Section 2 : Exemple Complet -->
    <div class="help-section">
        <h2>ğŸ“ Exemple Complet : Validation d'un Achat</h2>
        
        <div class="exemple-box">
            <strong>ScÃ©nario :</strong> Vous voulez crÃ©er un circuit pour valider les demandes d'achat de matÃ©riel informatique.
        </div>
        
        <h3>Ã‰tape 1 : CrÃ©er les RÃ´les</h3>
        
        <p>Allez dans l'onglet <strong>ğŸ‘¥ RÃ´les PersonnalisÃ©s</strong> et crÃ©ez :</p>
        
        <table class="table-help">
            <thead>
                <tr>
                    <th>Code</th>
                    <th>LibellÃ©</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code class="code-inline">EXPERT_IT</code></td>
                    <td>Expert Informatique</td>
                    <td>VÃ©rifie la faisabilitÃ© technique</td>
                </tr>
                <tr>
                    <td><code class="code-inline">RESP_BUDGET</code></td>
                    <td>Responsable Budget</td>
                    <td>VÃ©rifie la disponibilitÃ© budgÃ©taire</td>
                </tr>
                <tr>
                    <td><code class="code-inline">DIRECTEUR_GENERAL</code></td>
                    <td>Directeur GÃ©nÃ©ral</td>
                    <td>Approbation finale</td>
                </tr>
            </tbody>
        </table>
        
        <h3>Ã‰tape 2 : Attribuer les RÃ´les aux Agents</h3>
        
        <p>Pour chaque rÃ´le crÃ©Ã©, cliquez sur <strong>â• Attribuer</strong> et sÃ©lectionnez l'agent :</p>
        
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin: 1rem 0;">
            <div style="background: #e7f3ff; padding: 1rem; border-radius: 8px; text-align: center;">
                <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ‘¨â€ğŸ’»</div>
                <strong>Jean KOUASSI</strong>
                <div style="color: #666; font-size: 0.9rem;">â† EXPERT_IT</div>
            </div>
            <div style="background: #e7f3ff; padding: 1rem; border-radius: 8px; text-align: center;">
                <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ’°</div>
                <strong>Marie DIALLO</strong>
                <div style="color: #666; font-size: 0.9rem;">â† RESP_BUDGET</div>
            </div>
            <div style="background: #e7f3ff; padding: 1rem; border-radius: 8px; text-align: center;">
                <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ‘”</div>
                <strong>Paul BAMBA</strong>
                <div style="color: #666; font-size: 0.9rem;">â† DIRECTEUR_GENERAL</div>
            </div>
        </div>
        
        <h3>Ã‰tape 3 : CrÃ©er le Template</h3>
        
        <p>Allez dans l'onglet <strong>ğŸ“‹ Templates de Workflows</strong> et cliquez <strong>â• CrÃ©er un Template</strong> :</p>
        
        <div class="schema-box">
Code : CIRCUIT_ACHAT_IT
Nom : Circuit d'Achat MatÃ©riel IT
Direction : Ascendant (Agent â†’ HiÃ©rarchie)

ğŸ“‹ Circuit de Validation :

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1  Expert Informatique      [â¬‡ï¸] [âœ–ï¸]         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2  Responsable Budget       [â¬†ï¸] [â¬‡ï¸] [âœ–ï¸]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3  Directeur GÃ©nÃ©ral        [â¬†ï¸] [âœ–ï¸]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ‘¥ RÃ´les Disponibles :
[â• Expert Informatique] [â• Responsable Budget] [â• Directeur GÃ©nÃ©ral]
        </div>
        
        <h3>Ã‰tape 4 : CrÃ©er le Type de Demande</h3>
        
        <p>Allez dans l'onglet <strong>ğŸ“ Types de Demandes</strong> et crÃ©ez :</p>
        
        <div class="schema-box">
Code : DEMANDE_MATERIEL_IT
LibellÃ© : Demande de MatÃ©riel Informatique
Template : Circuit d'Achat MatÃ©riel IT
CatÃ©gorie : Informatique
        </div>
        
        <h3>RÃ©sultat Final</h3>
        
        <div class="flow-diagram">
            <div class="flow-step">Sophie<br><small>Demandeur</small></div>
            <span class="flow-arrow">â†’</span>
            <div class="flow-step">Jean<br><small>Expert IT</small></div>
            <span class="flow-arrow">â†’</span>
            <div class="flow-step">Marie<br><small>Resp Budget</small></div>
            <span class="flow-arrow">â†’</span>
            <div class="flow-step">Paul<br><small>DG</small></div>
            <span class="flow-arrow">â†’</span>
            <div class="flow-step" style="background: #28a745;">âœ…<br><small>ArchivÃ©</small></div>
        </div>
    </div>
    
    <!-- Section 3 : Fonctionnement Technique -->
    <div class="help-section">
        <h2>âš™ï¸ Comment Ã‡a Fonctionne ?</h2>
        
        <h3>1. CrÃ©ation d'une Demande</h3>
        
        <div class="schema-box">
Sophie (Agent) â†’ RH â†’ Nouvelle Demande
                â†“
          Choisit "Demande de MatÃ©riel IT"
                â†“
          Remplit le formulaire
                â†“
          Soumet la demande
                â†“
        Ã‰tat : SUBMITTED
        AssignÃ© Ã  : Expert IT (Jean KOUASSI)
        </div>
        
        <h3>2. Comment le SystÃ¨me Sait Qui Doit Valider ?</h3>
        
        <div class="step-box" style="margin: 1rem 0;">
            <div class="step-number">1</div>
            <strong>Le systÃ¨me rÃ©cupÃ¨re le template</strong>
            <p style="margin: 0.5rem 0 0 3rem; color: #666;">
                Type DEMANDE_MATERIEL_IT â†’ Template CIRCUIT_ACHAT_IT
            </p>
        </div>
        
        <div class="step-box" style="margin: 1rem 0;">
            <div class="step-number">2</div>
            <strong>Le systÃ¨me lit les Ã©tapes du template</strong>
            <p style="margin: 0.5rem 0 0 3rem; color: #666;">
                Ã‰tape 1 : EXPERT_IT<br>
                Ã‰tape 2 : RESP_BUDGET<br>
                Ã‰tape 3 : DIRECTEUR_GENERAL
            </p>
        </div>
        
        <div class="step-box" style="margin: 1rem 0;">
            <div class="step-number">3</div>
            <strong>Le systÃ¨me cherche qui a le rÃ´le EXPERT_IT</strong>
            <p style="margin: 0.5rem 0 0 3rem; color: #666;">
                RÃ´le EXPERT_IT â†’ AttribuÃ© Ã  Jean KOUASSI (ID: 15)
            </p>
        </div>
        
        <div class="step-box" style="margin: 1rem 0;">
            <div class="step-number">4</div>
            <strong>La demande est assignÃ©e Ã  Jean</strong>
            <p style="margin: 0.5rem 0 0 3rem; color: #666;">
                Jean voit la demande dans son dashboard<br>
                Seul Jean peut valider cette Ã©tape
            </p>
        </div>
        
        <h3>3. ContrÃ´le d'AccÃ¨s</h3>
        
        <div class="warning-box">
            <strong>âš ï¸ SÃ©curitÃ© :</strong> Seul l'agent ayant le rÃ´le de l'Ã©tape actuelle peut valider.
            Si quelqu'un d'autre essaie â†’ <strong>REFUS</strong> avec message d'erreur.
        </div>
        
        <div class="schema-box">
Exemple : Marie essaie de valider Ã  la place de Jean

Marie clique "Valider"
        â†“
SystÃ¨me vÃ©rifie :
  - Agent de Marie : ID 8
  - Agent attendu (EXPERT_IT) : ID 15 (Jean)
  - 8 â‰  15 â†’ âŒ REFUS
        â†“
Message affichÃ© :
"âŒ Vous n'Ãªtes pas autorisÃ©.
 Cette action doit Ãªtre effectuÃ©e par : Jean KOUASSI"
        </div>
    </div>
    
    <!-- Section 4 : Guide Pas Ã  Pas -->
    <div class="help-section">
        <h2>ğŸš€ Guide Pas Ã  Pas : CrÃ©er Votre Premier Workflow</h2>
        
        <h3>ScÃ©nario : Circuit de Validation Simple</h3>
        
        <p>Objectif : <em>Toute demande passe par le Chef de Service puis le Directeur</em></p>
        
        <div style="background: #f8f9fa; padding: 2rem; border-radius: 8px; margin: 1.5rem 0;">
            
            <h4 style="color: var(--primary-color); margin-top: 0;">ğŸ“Œ Ã‰tape 1 : CrÃ©er les RÃ´les</h4>
            
            <ol style="line-height: 2;">
                <li>Cliquez sur l'onglet <strong>ğŸ‘¥ RÃ´les PersonnalisÃ©s</strong></li>
                <li>Cliquez sur <strong>â• CrÃ©er un RÃ´le</strong></li>
                <li>Remplissez :
                    <ul>
                        <li>Code : <code class="code-inline">CHEF_SERVICE</code></li>
                        <li>LibellÃ© : <code class="code-inline">Chef de Service</code></li>
                        <li>Description : <code class="code-inline">Valide les demandes de son service</code></li>
                    </ul>
                </li>
                <li>Cliquez <strong>Enregistrer</strong></li>
                <li>RÃ©pÃ©tez pour crÃ©er le rÃ´le <code class="code-inline">DIRECTEUR</code></li>
            </ol>
            
            <h4 style="color: var(--primary-color);">ğŸ“Œ Ã‰tape 2 : Attribuer les RÃ´les</h4>
            
            <ol style="line-height: 2;">
                <li>Sur la carte du rÃ´le <strong>CHEF_SERVICE</strong>, cliquez <strong>â• Attribuer</strong></li>
                <li>SÃ©lectionnez l'agent dans la liste (ex: Jean KOUASSI)</li>
                <li>Cliquez <strong>Attribuer</strong></li>
                <li>Vous verrez : <span style="color: #28a745;">âœ“ AttribuÃ© Ã  Jean KOUASSI</span></li>
                <li>RÃ©pÃ©tez pour <strong>DIRECTEUR</strong> â†’ Attribuez Ã  Marie DIALLO</li>
            </ol>
            
            <h4 style="color: var(--primary-color);">ğŸ“Œ Ã‰tape 3 : CrÃ©er le Template</h4>
            
            <ol style="line-height: 2;">
                <li>Cliquez sur l'onglet <strong>ğŸ“‹ Templates de Workflows</strong></li>
                <li>Cliquez <strong>â• CrÃ©er un Template</strong></li>
                <li>Remplissez :
                    <ul>
                        <li>Code : <code class="code-inline">CIRCUIT_SIMPLE</code></li>
                        <li>Nom : <code class="code-inline">Circuit Simple 2 Niveaux</code></li>
                        <li>Direction : <strong>â¬†ï¸ Ascendant</strong></li>
                    </ul>
                </li>
                <li>Dans <strong>ğŸ‘¥ RÃ´les Disponibles</strong>, cliquez :
                    <ul>
                        <li>D'abord : <strong>â• Chef de Service</strong> (devient Ã©tape 1)</li>
                        <li>Ensuite : <strong>â• Directeur</strong> (devient Ã©tape 2)</li>
                    </ul>
                </li>
                <li>Vous verrez le circuit se construire :
                    <div class="schema-box" style="margin-top: 0.5rem;">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1  Chef de Service    [â¬‡ï¸] [âœ–ï¸]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2  Directeur          [â¬†ï¸] [âœ–ï¸]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </div>
                </li>
                <li>Cliquez <strong>Enregistrer</strong></li>
            </ol>
            
            <h4 style="color: var(--primary-color);">ğŸ“Œ Ã‰tape 4 : CrÃ©er le Type de Demande</h4>
            
            <ol style="line-height: 2;">
                <li>Cliquez sur l'onglet <strong>ğŸ“ Types de Demandes</strong></li>
                <li>Cliquez <strong>â• CrÃ©er un Type de Demande</strong></li>
                <li>Remplissez :
                    <ul>
                        <li>Code : <code class="code-inline">DEMANDE_FOURNITURE</code></li>
                        <li>LibellÃ© : <code class="code-inline">Demande de Fourniture</code></li>
                        <li>Template : SÃ©lectionnez <strong>Circuit Simple 2 Niveaux</strong></li>
                        <li>CatÃ©gorie : <code class="code-inline">Logistique</code></li>
                    </ul>
                </li>
                <li>Cliquez <strong>Enregistrer</strong></li>
            </ol>
            
            <div class="success-box" style="margin-top: 1.5rem;">
                <strong>ğŸ‰ C'est terminÃ© !</strong><br>
                Le type de demande est maintenant disponible pour tous les utilisateurs.
            </div>
        </div>
    </div>
    
    <!-- Section 5 : Utilisation -->
    <div class="help-section">
        <h2>ğŸ® Utilisation par les Agents</h2>
        
        <h3>CrÃ©er une Demande</h3>
        
        <div class="flow-diagram" style="text-align: left;">
            <div style="display: grid; grid-template-columns: 50px 1fr; gap: 1rem; align-items: start;">
                <div style="text-align: center;">
                    <div class="step-number">1</div>
                </div>
                <div>
                    Sophie va dans <strong>RH â†’ Nouvelle Demande</strong>
                </div>
                
                <div style="text-align: center;">
                    <div class="step-number">2</div>
                </div>
                <div>
                    Elle choisit le type <strong>Demande de Fourniture</strong>
                </div>
                
                <div style="text-align: center;">
                    <div class="step-number">3</div>
                </div>
                <div>
                    Elle remplit le formulaire et clique <strong>Soumettre</strong>
                </div>
                
                <div style="text-align: center;">
                    <div class="step-number">4</div>
                </div>
                <div>
                    La demande est automatiquement assignÃ©e Ã  <strong>Jean KOUASSI</strong> (Chef de Service)
                </div>
            </div>
        </div>
        
        <h3>Validation</h3>
        
        <div class="schema-box">
Jean se connecte
    â†“
Dashboard RH â†’ "Demandes en attente"
    â†“
Voit la demande de Sophie
    â†“
Clique "Valider"
    â†“
âœ… Demande passe Ã  Marie (Directeur)
    â†“
Marie se connecte
    â†“
Voit la demande dans son dashboard
    â†“
Clique "Valider"
    â†“
âœ… Demande ARCHIVÃ‰E (terminÃ©e)
        </div>
    </div>
    
    <!-- Section 6 : FonctionnalitÃ©s AvancÃ©es -->
    <div class="help-section">
        <h2>ğŸ¨ FonctionnalitÃ©s AvancÃ©es</h2>
        
        <h3>RÃ©organiser l'Ordre des Ã‰tapes</h3>
        
        <p>Dans le builder de circuit, utilisez les boutons :</p>
        
        <ul style="line-height: 2;">
            <li><strong>â¬†ï¸</strong> : Remonter l'Ã©tape (elle sera validÃ©e plus tÃ´t)</li>
            <li><strong>â¬‡ï¸</strong> : Descendre l'Ã©tape (elle sera validÃ©e plus tard)</li>
            <li><strong>âœ–ï¸</strong> : Retirer l'Ã©tape du circuit</li>
        </ul>
        
        <div class="exemple-box">
            <strong>Exemple :</strong> Vous voulez que le Directeur valide AVANT le Responsable Budget ?<br>
            â†’ Cliquez sur â¬†ï¸ Ã  cÃ´tÃ© de "Directeur" pour le faire monter en position 1
        </div>
        
        <h3>Attribution Temporaire (IntÃ©rim)</h3>
        
        <p>Lors de l'attribution d'un rÃ´le, vous pouvez dÃ©finir une <strong>date de fin</strong> :</p>
        
        <div class="schema-box">
ScÃ©nario : Marie est en congÃ©, Paul la remplace

1. Aller sur le rÃ´le RESP_BUDGET
2. Cliquer "ğŸ‘¥ GÃ©rer"
3. Cliquer "âœ–ï¸ RÃ©voquer" Ã  cÃ´tÃ© de Marie
4. Cliquer "â• Ajouter une nouvelle attribution"
5. SÃ©lectionner Paul
6. Date de fin : 2025-12-31
7. Valider

RÃ©sultat :
- Paul a le rÃ´le jusqu'au 31/12/2025
- AprÃ¨s cette date, le rÃ´le n'est plus attribuÃ©
        </div>
        
        <h3>Plusieurs Agents pour un MÃªme RÃ´le</h3>
        
        <p>Vous pouvez attribuer le mÃªme rÃ´le Ã  plusieurs agents :</p>
        
        <div class="exemple-box">
            <strong>Cas d'usage :</strong> ComitÃ© de validation<br><br>
            
            CrÃ©er le rÃ´le <code class="code-inline">MEMBRE_COMITE</code><br>
            Attribuer Ã  3 personnes diffÃ©rentes<br>
            CrÃ©er un template avec 3 Ã©tapes du mÃªme rÃ´le<br><br>
            
            <strong>RÃ©sultat :</strong> Les 3 membres doivent valider successivement
        </div>
        
        <h3>GÃ©rer les Modifications</h3>
        
        <table class="table-help">
            <thead>
                <tr>
                    <th>Action</th>
                    <th>Comment</th>
                    <th>Effet</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Changer l'agent d'un rÃ´le</strong></td>
                    <td>GÃ©rer â†’ RÃ©voquer â†’ Attribuer Ã  un autre</td>
                    <td>Les nouvelles demandes iront au nouvel agent</td>
                </tr>
                <tr>
                    <td><strong>Modifier un template</strong></td>
                    <td>Cliquer âœï¸ Ã‰diter</td>
                    <td>Ajouter/retirer des Ã©tapes, changer l'ordre</td>
                </tr>
                <tr>
                    <td><strong>DÃ©sactiver un type</strong></td>
                    <td>ğŸ—‘ï¸ Menu â†’ DÃ©sactiver</td>
                    <td>Plus disponible pour nouvelles demandes</td>
                </tr>
                <tr>
                    <td><strong>Supprimer dÃ©finitivement</strong></td>
                    <td>ğŸ—‘ï¸ Menu â†’ Supprimer dÃ©finitivement</td>
                    <td>EffacÃ© de la base (irrÃ©versible)</td>
                </tr>
            </tbody>
        </table>
    </div>
    
    <!-- Section 7 : Exemples de Circuits -->
    <div class="help-section">
        <h2>ğŸ“Š Exemples de Circuits Courants</h2>
        
        <div style="display: grid; gap: 1.5rem;">
            
            <div style="border: 2px solid #3498db; border-radius: 8px; padding: 1.5rem;">
                <h4 style="margin-top: 0; color: #3498db;">ğŸ”¹ Circuit Express (1 Niveau)</h4>
                <p><strong>Usage :</strong> Demandes simples et rapides</p>
                <div class="schema-box">
RÃ´les : SUPERVISEUR
Template : [SUPERVISEUR]
Type : DEMANDE_PERMISSION

Circuit : Agent â†’ Superviseur â†’ ArchivÃ©
                </div>
            </div>
            
            <div style="border: 2px solid #28a745; border-radius: 8px; padding: 1.5rem;">
                <h4 style="margin-top: 0; color: #28a745;">ğŸ”¹ Circuit Standard (2-3 Niveaux)</h4>
                <p><strong>Usage :</strong> Demandes courantes</p>
                <div class="schema-box">
RÃ´les : CHEF_SERVICE, SOUS_DIRECTEUR, DIRECTEUR
Template : [CHEF_SERVICE, SOUS_DIRECTEUR, DIRECTEUR]
Type : DEMANDE_MATERIEL

Circuit : Agent â†’ Chef â†’ Sous-dir â†’ Directeur â†’ ArchivÃ©
                </div>
            </div>
            
            <div style="border: 2px solid #e74c3c; border-radius: 8px; padding: 1.5rem;">
                <h4 style="margin-top: 0; color: #e74c3c;">ğŸ”¹ Circuit Expertise (Validation Technique)</h4>
                <p><strong>Usage :</strong> Demandes nÃ©cessitant un avis technique</p>
                <div class="schema-box">
RÃ´les : EXPERT_TECHNIQUE, RESP_BUDGET, DIRECTEUR
Template : [EXPERT_TECHNIQUE, RESP_BUDGET, DIRECTEUR]
Type : DEMANDE_PROJET

Circuit : Agent â†’ Expert â†’ Resp Budget â†’ Directeur â†’ ArchivÃ©
                </div>
            </div>
            
            <div style="border: 2px solid #9b59b6; border-radius: 8px; padding: 1.5rem;">
                <h4 style="margin-top: 0; color: #9b59b6;">ğŸ”¹ Circuit ComitÃ© (Validation CollÃ©giale)</h4>
                <p><strong>Usage :</strong> DÃ©cisions importantes</p>
                <div class="schema-box">
RÃ´les : MEMBRE_1, MEMBRE_2, MEMBRE_3, PRESIDENT
Template : [MEMBRE_1, MEMBRE_2, MEMBRE_3, PRESIDENT]
Type : DEMANDE_SENSIBLE

Circuit : Agent â†’ Membre 1 â†’ Membre 2 â†’ Membre 3 â†’ PrÃ©sident â†’ ArchivÃ©
                </div>
            </div>
        </div>
    </div>
    
    <!-- Section 8 : DÃ©pannage -->
    <div class="help-section">
        <h2>ğŸ”§ DÃ©pannage Courant</h2>
        
        <h3>âŒ ProblÃ¨me : "Le rÃ´le n'est attribuÃ© Ã  aucun agent"</h3>
        <div class="warning-box">
            <strong>Cause :</strong> Vous avez crÃ©Ã© un rÃ´le mais ne l'avez pas attribuÃ© Ã  un agent.<br><br>
            <strong>Solution :</strong>
            <ol>
                <li>Allez dans "RÃ´les PersonnalisÃ©s"</li>
                <li>Trouvez le rÃ´le concernÃ©</li>
                <li>Cliquez "â• Attribuer"</li>
                <li>SÃ©lectionnez un agent</li>
            </ol>
        </div>
        
        <h3>âŒ ProblÃ¨me : "Vous n'Ãªtes pas autorisÃ© Ã  valider"</h3>
        <div class="warning-box">
            <strong>Cause :</strong> Vous essayez de valider une demande qui n'est pas assignÃ©e Ã  votre rÃ´le.<br><br>
            <strong>Solution :</strong> Seul l'agent ayant le rÃ´le de l'Ã©tape actuelle peut valider. VÃ©rifiez les attributions.
        </div>
        
        <h3>âŒ ProblÃ¨me : "Mon nouvel agent ne s'affiche pas"</h3>
        <div class="warning-box">
            <strong>Cause :</strong> Le modal ne recharge pas automatiquement la liste.<br><br>
            <strong>Solution :</strong> Fermez et rouvrez le modal d'attribution.
        </div>
        
        <h3>âŒ ProblÃ¨me : "Le template ne contient pas d'Ã©tapes"</h3>
        <div class="warning-box">
            <strong>Cause :</strong> Vous avez crÃ©Ã© un template sans ajouter de rÃ´les.<br><br>
            <strong>Solution :</strong> Ã‰ditez le template et ajoutez au moins un rÃ´le au circuit.
        </div>
    </div>
    
    <!-- Section 9 : SchÃ©ma Complet -->
    <div class="help-section">
        <h2>ğŸ—ºï¸ SchÃ©ma Complet du SystÃ¨me</h2>
        
        <div class="schema-box" style="font-size: 0.9rem;">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. CONFIGURATION (Admin)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ CrÃ©er RÃ´les PersonnalisÃ©s         â”‚
        â”‚ - EXPERT_IT                       â”‚
        â”‚ - RESP_BUDGET                     â”‚
        â”‚ - DIRECTEUR                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Attribuer RÃ´les aux Agents        â”‚
        â”‚ - EXPERT_IT â†’ Jean                â”‚
        â”‚ - RESP_BUDGET â†’ Marie             â”‚
        â”‚ - DIRECTEUR â†’ Paul                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ CrÃ©er Template                    â”‚
        â”‚ Circuit : EXPERT_IT â†’             â”‚
        â”‚          RESP_BUDGET â†’            â”‚
        â”‚          DIRECTEUR                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ CrÃ©er Type de Demande             â”‚
        â”‚ DEMANDE_IT â†’ Template crÃ©Ã©        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. UTILISATION (Agent)                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Sophie crÃ©e une DEMANDE_IT        â”‚
        â”‚ Ã‰tat : SUBMITTED                  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. SYSTÃˆME (Automatique)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ HierarchyService dÃ©termine :      â”‚
        â”‚ - Template de DEMANDE_IT          â”‚
        â”‚ - Ã‰tape 1 = EXPERT_IT             â”‚
        â”‚ - Qui a EXPERT_IT ? Jean          â”‚
        â”‚ â†’ Assigne Ã  Jean                  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. VALIDATION (Jean)                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Jean voit la demande              â”‚
        â”‚ Clique "Valider"                  â”‚
        â”‚ â†’ Passe Ã  Marie (RESP_BUDGET)     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Marie valide                      â”‚
        â”‚ â†’ Passe Ã  Paul (DIRECTEUR)        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Paul valide                       â”‚
        â”‚ â†’ ARCHIVÃ‰ âœ…                      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        </div>
    </div>
    
    <!-- Section 10 : Bonnes Pratiques -->
    <div class="help-section">
        <h2>ğŸ’¡ Bonnes Pratiques</h2>
        
        <div style="display: grid; gap: 1rem;">
            <div class="success-box">
                <strong>âœ… Nommer clairement les rÃ´les</strong><br>
                Utilisez des noms explicites : <code class="code-inline">RESP_BUDGET</code> plutÃ´t que <code class="code-inline">ROLE_1</code>
            </div>
            
            <div class="success-box">
                <strong>âœ… Commencer simple</strong><br>
                CrÃ©ez d'abord des circuits courts (1-2 Ã©tapes) pour tester, puis complexifiez
            </div>
            
            <div class="success-box">
                <strong>âœ… Documenter vos templates</strong><br>
                Utilisez le champ "Description" pour expliquer quand utiliser chaque template
            </div>
            
            <div class="success-box">
                <strong>âœ… Tester avant de dÃ©ployer</strong><br>
                CrÃ©ez une demande de test et suivez tout le circuit pour vÃ©rifier
            </div>
            
            <div class="success-box">
                <strong>âœ… VÃ©rifier les attributions</strong><br>
                Utilisez "ğŸ‘¥ GÃ©rer" pour voir qui a quels rÃ´les
            </div>
        </div>
    </div>
    
    <!-- Section 11 : FAQ -->
    <div class="help-section">
        <h2>â“ Questions FrÃ©quentes</h2>
        
        <div style="margin: 1.5rem 0;">
            <h4 style="color: #333;">Q : Puis-je crÃ©er autant de rÃ´les que je veux ?</h4>
            <p style="margin-left: 1.5rem; color: #666;">
                <strong>R :</strong> Oui ! Il n'y a aucune limitation. CrÃ©ez autant de rÃ´les que nÃ©cessaire pour vos processus.
            </p>
        </div>
        
        <div style="margin: 1.5rem 0;">
            <h4 style="color: #333;">Q : Un agent peut-il avoir plusieurs rÃ´les ?</h4>
            <p style="margin-left: 1.5rem; color: #666;">
                <strong>R :</strong> Oui ! Un mÃªme agent peut avoir plusieurs rÃ´les diffÃ©rents (ex: EXPERT_IT + RESP_BUDGET).
            </p>
        </div>
        
        <div style="margin: 1.5rem 0;">
            <h4 style="color: #333;">Q : Combien d'Ã©tapes maximum dans un circuit ?</h4>
            <p style="margin-left: 1.5rem; color: #666;">
                <strong>R :</strong> Actuellement 4 Ã©tapes maximum (VALIDATION_N1, N2, RH, SIGNATURE_DAF). Techniquement extensible si besoin.
            </p>
        </div>
        
        <div style="margin: 1.5rem 0;">
            <h4 style="color: #333;">Q : Que se passe-t-il si un rÃ´le n'est pas attribuÃ© ?</h4>
            <p style="margin-left: 1.5rem; color: #666;">
                <strong>R :</strong> La demande restera bloquÃ©e Ã  cette Ã©tape. Assurez-vous que tous les rÃ´les utilisÃ©s dans vos templates sont attribuÃ©s.
            </p>
        </div>
        
        <div style="margin: 1.5rem 0;">
            <h4 style="color: #333;">Q : Puis-je modifier un template dÃ©jÃ  utilisÃ© ?</h4>
            <p style="margin-left: 1.5rem; color: #666;">
                <strong>R :</strong> Oui, mais attention : les demandes en cours continueront avec l'ancien circuit. Seules les nouvelles demandes utiliseront le circuit modifiÃ©.
            </p>
        </div>
        
        <div style="margin: 1.5rem 0;">
            <h4 style="color: #333;">Q : Comment savoir qui doit valider une demande ?</h4>
            <p style="margin-left: 1.5rem; color: #666;">
                <strong>R :</strong> Chaque utilisateur voit dans son dashboard RH les demandes qu'il doit valider. Le systÃ¨me filtre automatiquement selon les rÃ´les attribuÃ©s.
            </p>
        </div>
    </div>
    
    <!-- Section 12 : Pour Aller Plus Loin -->
    <div class="help-section">
        <h2>ğŸ“š Pour Aller Plus Loin</h2>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
            <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px;">
                <h4 style="margin-top: 0;">ğŸ“– Documentation Technique</h4>
                <p style="color: #666;">Consultez le fichier :</p>
                <code class="code-inline">WORKFLOWS_PERSONNALISES_ARCHITECTURE.md</code>
            </div>
            
            <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px;">
                <h4 style="margin-top: 0;">ğŸ“ Guide d'Attribution</h4>
                <p style="color: #666;">Pour comprendre les attributions :</p>
                <code class="code-inline">GUIDE_ATTRIBUTION_ROLES.md</code>
            </div>
            
            <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px;">
                <h4 style="margin-top: 0;">ğŸ’¬ Support</h4>
                <p style="color: #666;">Besoin d'aide supplÃ©mentaire ?</p>
                <p>Consultez les logs dans <code class="code-inline">logs/app.log</code></p>
            </div>
        </div>
    </div>
    
    <!-- Bouton retour -->
    <div style="text-align: center; margin: 2rem 0;">
        <a href="{{ url_for('workflow_config_home') }}" class="btn btn-primary" style="padding: 1rem 2rem; font-size: 1.1rem; text-decoration: none;">
            â† Retour Ã  la Configuration
        </a>
    </div>

</div>

{% endblock %}


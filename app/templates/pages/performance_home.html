{% extends "layouts/base.html" %}
{% from 'components/page_header.html' import page_header %}

{% block title %}Performance - {{ app_name }}{% endblock %}

{% block styles %}
<style>
/* Styles sp√©cifiques au module Performance */
.performance-dashboard {
    margin-top: 2rem;
}

.dashboard-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 1rem;
    margin-bottom: 3rem;
}

.kpi-card {
    background: white;
    border-radius: 12px;
    padding: 1rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    border-left: 4px solid var(--primary-color);
    transition: transform 0.2s ease;
}

.kpi-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
}

.kpi-icon {
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
    color: var(--primary-color);
}

.kpi-title {
    font-size: 0.7rem;
    color: #6b7280;
    font-weight: 500;
    margin-bottom: 0.3rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    line-height: 1.2;
}

.kpi-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: #1f2937;
    margin-bottom: 0.3rem;
}

.kpi-change {
    font-size: 0.65rem;
    font-weight: 500;
    line-height: 1.2;
}

.kpi-change.positive {
    color: #10b981;
}

.kpi-change.negative {
    color: #ef4444;
}

.kpi-change.neutral {
    color: #6b7280;
}

/* Section des graphiques */
.charts-section {
    margin-top: 3rem;
}

.charts-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 2rem;
    margin-top: 2rem;
}

.chart-card {
    background: white;
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.chart-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: #1f2937;
    margin-bottom: 1rem;
}

.chart-placeholder {
    height: 300px;
    background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #6b7280;
    font-size: 1rem;
    text-align: center;
}

/* Section des actions rapides */
.quick-actions {
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    border-radius: 12px;
    padding: 2rem;
    margin-top: 2rem;
}

.quick-actions h3 {
    color: #2d3748;
    font-size: 1.5rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
    text-align: center;
}

.actions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.action-button {
    background: white;
    border: none;
    border-radius: 12px;
    padding: 1.5rem;
    text-decoration: none;
    color: #2d3748;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    cursor: pointer;
}

.action-button:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    color: var(--primary-color);
}

.action-icon {
    font-size: 2rem;
    margin-bottom: 0.75rem;
    display: block;
}

.action-text {
    font-size: 0.9rem;
    font-weight: 500;
    line-height: 1.3;
}

/* Section d'introduction */
.intro-section {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 2rem;
    text-align: center;
    color: white;
}

.intro-title {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 1rem;
}

.intro-description {
    font-size: 1.1rem;
    opacity: 0.9;
    max-width: 600px;
    margin: 0 auto;
    line-height: 1.6;
}

/* Responsive */
@media (max-width: 1200px) {
    .dashboard-grid {
        grid-template-columns: repeat(3, 1fr);
    }
}

@media (max-width: 768px) {
    .dashboard-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .charts-grid {
        grid-template-columns: 1fr;
    }
    
    .actions-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 480px) {
    .dashboard-grid {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}

{% block content %}
{{ page_header(
    title='üìä Performance Organisationnelle',
    breadcrumbs=[
        {'name': 'Accueil', 'url': url_for('accueil')},
        {'name': 'Performance'}
    ],
    actions=[
        {'label': '‚ùì Aide', 'url': url_for('aide_performance'), 'primary': False},
        {'label': '‚Üê Retour Accueil', 'url': url_for('accueil'), 'primary': False}
    ]
) }}

<div class="performance-dashboard">
    <!-- KPIs Principaux -->
    <div class="dashboard-grid">
        <!-- KPI 1: Taux de R√©alisation -->
        <div class="kpi-card">
            <div class="kpi-icon">üéØ</div>
            <div class="kpi-title">Taux de R√©alisation</div>
            <div class="kpi-value">{{ kpis.taux_realisation }}%</div>
            <div class="kpi-change {% if kpis.taux_realisation >= 80 %}positive{% elif kpis.taux_realisation >= 50 %}neutral{% else %}negative{% endif %}">
                {% if kpis.total_objectifs > 0 %}
                    {{ kpis.objectifs_atteints }} / {{ kpis.total_objectifs }} objectifs
                {% else %}
                    Aucun objectif d√©fini
                {% endif %}
            </div>
        </div>

        <!-- KPI 2: Objectifs Atteints -->
        <div class="kpi-card">
            <div class="kpi-icon">‚úÖ</div>
            <div class="kpi-title">Objectifs Atteints</div>
            <div class="kpi-value">{{ kpis.objectifs_atteints }}</div>
            <div class="kpi-change neutral">
                Sur {{ kpis.total_objectifs }} au total
            </div>
        </div>

        <!-- KPI 3: Indicateurs en Alerte -->
        <div class="kpi-card">
            <div class="kpi-icon">‚ö†Ô∏è</div>
            <div class="kpi-title">Indicateurs en Alerte</div>
            <div class="kpi-value">{{ kpis.indicateurs_alerte }}</div>
            <div class="kpi-change {% if kpis.indicateurs_alerte > 0 %}negative{% else %}positive{% endif %}">
                {% if kpis.indicateurs_alerte > 0 %}
                    ‚ö†Ô∏è N√©cessitent attention
                {% else %}
                    ‚úÖ Tous les indicateurs OK
                {% endif %}
            </div>
        </div>

        <!-- KPI 4: Score Global -->
        <div class="kpi-card">
            <div class="kpi-icon">‚≠ê</div>
            <div class="kpi-title">Score Global</div>
            <div class="kpi-value">{{ kpis.score_global }}/10</div>
            <div class="kpi-change {% if kpis.score_global >= 7 %}positive{% elif kpis.score_global >= 5 %}neutral{% else %}negative{% endif %}">
                {% if kpis.score_global >= 7 %}
                    ‚úÖ Performance √©lev√©e
                {% elif kpis.score_global >= 5 %}
                    ‚ö†Ô∏è Performance moyenne
                {% else %}
                    ‚ùå √Ä am√©liorer
                {% endif %}
            </div>
        </div>

        <!-- KPI 5: Objectifs en Cours -->
        <div class="kpi-card">
            <div class="kpi-icon">üèÉ</div>
            <div class="kpi-title">Objectifs en Cours</div>
            <div class="kpi-value">{{ kpis.objectifs_en_cours }}</div>
            <div class="kpi-change neutral">
                En progression
            </div>
        </div>

        <!-- KPI 6: Rapports G√©n√©r√©s -->
        <div class="kpi-card">
            <div class="kpi-icon">üìä</div>
            <div class="kpi-title">Rapports G√©n√©r√©s</div>
            <div class="kpi-value">{{ kpis.total_rapports }}</div>
            <div class="kpi-change neutral">
                Disponibles
            </div>
        </div>
    </div>

    <!-- Section des graphiques -->
    <div class="charts-section">
        <h2 style="color: #1f2937; font-size: 1.5rem; font-weight: 600; margin-bottom: 1rem;">
            üìä Analyses et Tendances
        </h2>
        
        <div class="charts-grid">
            <!-- Graphique √âvolution des Objectifs -->
            <div class="chart-card">
                <h3 class="chart-title">√âvolution des Objectifs (6 derniers mois)</h3>
                <div class="chart-placeholder">
                    üìà Graphique d'√©volution des objectifs<br>
                    <small>Les graphiques interactifs seront int√©gr√©s prochainement</small>
                </div>
            </div>

            <!-- Graphique Performance par Programme -->
            <div class="chart-card">
                <h3 class="chart-title">Performance par Programme</h3>
                <div class="chart-placeholder">
                    üìä Graphique en barres par programme<br>
                    <small>Comparaison des performances par secteur</small>
                </div>
            </div>

            <!-- Graphique Indicateurs Cl√©s -->
            <div class="chart-card">
                <h3 class="chart-title">Indicateurs Cl√©s de Performance</h3>
                <div class="chart-placeholder">
                    üéØ Graphique radar des KPIs<br>
                    <small>Vue d'ensemble des indicateurs principaux</small>
                </div>
            </div>

            <!-- Graphique Tendances -->
            <div class="chart-card">
                <h3 class="chart-title">Tendances et Pr√©visions</h3>
                <div class="chart-placeholder">
                    üìà Graphique de tendances<br>
                    <small>Projections et analyses pr√©dictives</small>
                </div>
            </div>
        </div>
    </div>

    <!-- Actions Rapides -->
    <div class="quick-actions">
        <h3>Actions Rapides</h3>
        <div class="actions-grid">
            <a href="{{ url_for('performance_objectifs') }}" class="action-button">
                <span class="action-icon">üéØ</span>
                <span class="action-text">G√©rer les Objectifs</span>
            </a>
            <a href="{{ url_for('performance_indicateurs') }}" class="action-button">
                <span class="action-icon">üìä</span>
                <span class="action-text">Configurer les Indicateurs</span>
            </a>
            <a href="{{ url_for('performance_rapports') }}" class="action-button">
                <span class="action-icon">üìã</span>
                <span class="action-text">G√©n√©rer un Rapport</span>
            </a>
        </div>
    </div>
</div>

<script>
function showComingSoon(feature) {
    showInfo(`La fonctionnalit√© "${feature}" sera bient√¥t disponible !`);
}

// S'assurer que l'overlay est ferm√© au chargement de la page
document.addEventListener('DOMContentLoaded', function() {
    const overlay = document.getElementById('globalLoadingOverlay');
    if (overlay) {
        overlay.classList.remove('show');
    }
});
</script>
{% endblock %}
